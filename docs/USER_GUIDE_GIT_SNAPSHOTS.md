# User's Guide: Snapshot Storage in Git

*Part of the [SwiftUIFlowTesting User's Guide](../README.md) series.*

SwiftUIFlowTesting itself does not manage snapshot images — that's handled by [SnapshotTesting](https://github.com/pointfreeco/swift-snapshot-testing) in your test target. This guide covers strategies for storing those images in version control.

## How Snapshots Work

SnapshotTesting stores reference images in `__Snapshots__/` folders alongside your test files:

```
Tests/
  MyAppTests/
    CheckoutFlowTests.swift
    __Snapshots__/
      CheckoutFlowTests/
        checkout-cart.png
        checkout-payment.png
        checkout-confirmation.png
```

## Storage Strategies

### Direct Git (Small Projects)

For projects with fewer than ~100 snapshots, store images directly in git:

```gitattributes
# .gitattributes
*__Snapshots__/*.png binary
```

- Simple setup, no extra tooling
- PR diffs show image changes inline on GitHub/GitLab
- Repository size grows modestly (~100-500KB per snapshot)

### Git LFS (Medium Projects)

For projects with many snapshots or frequent visual changes:

```bash
git lfs install
git lfs track "*__Snapshots__/*.png"
git add .gitattributes
```

```gitattributes
# .gitattributes (auto-generated by git lfs track)
*__Snapshots__/*.png filter=lfs diff=lfs merge=lfs -text
```

- Keeps the repository lean (pointers instead of blobs)
- GitHub/GitLab still show image diffs in PRs
- CI needs `git lfs checkout` before running tests

### External Storage (Large Projects)

For very large snapshot suites, consider:

- `.gitignore` the `__Snapshots__/` directories
- Record snapshots on CI only
- Use a dedicated service (e.g., Percy, Chromatic) for hosted visual diffs

This trades PR reviewability for repository size control.

## AI Agent Interaction

AI agents (Claude Code, etc.) never need to read or process snapshot images. They only interact with:

- **Test code** — the `.swift` files containing `FlowTester` chains
- **Snapshot names** — the string identifiers passed to `assertSnapshot`
- **Failure messages** — text output indicating which snapshot didn't match

When an agent sees a snapshot failure, the correct response is to fix the model/view code, not to edit PNG files.

## Practical Tips

- Use kebab-case step names (`"payment-form"`, not `"paymentForm"`) for readable file names
- Name your `FlowTester` to get prefixed snapshots: `"checkout-cart"` instead of just `"cart"`
- Delete obsolete snapshots when removing tests to avoid repository bloat
- Review snapshot diffs in PRs to catch unintended visual regressions

## Next Steps

- [Overview](USER_GUIDE_OVERVIEW.md) — motivation and design philosophy
- [Quick Start](USER_GUIDE_QUICK_START.md) — installation and first test
- [AI Guide](USER_GUIDE_AI_GUIDE.md) — using with AI agents
- [API Reference](API_SPEC.md) — complete type and method reference
